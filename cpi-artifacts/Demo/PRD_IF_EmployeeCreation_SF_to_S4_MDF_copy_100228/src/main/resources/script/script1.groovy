import com.sap.gateway.ip.core.customdev.util.Message;import java.util.HashMap;import java.text.DateFormat;import java.text.SimpleDateFormat;import java.util.Date;def Message processData(Message message) {	 def body = message.getBody();StringBuffer str = new StringBuffer();		def pMap = message.getProperties();                   	def last_modified_on = pMap.get("LastModifiedOn");         /* Read last successful run date & Time  */    def today = pMap.get("Today");                             /* Today's date and time   */	def Mode = pMap.get("ExecutionMode");                      /* Read defined execution mode from Configure  */	def person_id_external_ext = pMap.get("PersonIdFilter");   /* Read person id filter values from Configure  */	/*    --------------------------------------------------------------------    */	/*    ***** 1. EmployeeID filter case: Maintained in Configure options *****  *//*    >>This won't respect the execution mode...either Full/Delta             *//*    --------------------------------------------------------------------    */	if(!(person_id_external_ext.trim().isEmpty()))             /*PersonalID   */	{				    str.append("person_id_external in (" + person_id_external_ext + ") AND EFFECTIVE_END_DATE = to_date('$today','YYYY-MM-DD') order by start_date desc AND isContingentWorker IN ('true','false')");	}/*    --------------------------------------------------------------------    */	/*    ***** 2. FULL MODE CASE : Maintained in Configure options *****         *//*    Person id filter should be blank always                                 *//*    This mode runs, to extract all active employee's in Maveric             *//*    --------------------------------------------------------------------    */		else if(Mode.equalsIgnoreCase("FULL")) 	{ /*      Get all the employee's from Maveric Successfactors system             */        str.append("EFFECTIVE_END_DATE = to_date('$today','YYYY-MM-DD') AND isContingentWorker IN ('true','false') order by start_date desc"); /*	    str.append("person_id_external in (" + person_id_external_ext + ") AND EFFECTIVE_END_DATE = to_date('$today','YYYY-MM-DD') order by start_date desc AND isContingentWorker IN ('true','false')");  */               message.setProperty("FullMode", "yes");	}/*    --------------------------------------------------------------------    */	/*    ***** 3. DELTA MODE CASE : Maintained in Configure options *****        *//*    Person id filter should be blank always, otherwise it wont work         *//*    This mode runs for only delta data for all Maveric employee's           *//*    Delta = last successful run date & time <Between> Current Interface scheduled date & time.     *//*    After successful run, the scheduled interface will update the date&time stamp in the variable. *//*    --------------------------------------------------------------------    */	else if(Mode.equalsIgnoreCase("DELTA")) 	{ 	    message.setProperty("DeltaMode", 'yes');	    	        if(last_modified_on.isEmpty())	        {                str.append("person_id_external NOT IN ('1','2') AND EFFECTIVE_END_DATE = to_date('$today','YYYY-MM-DD') order by start_date desc AND isContingentWorker IN ('true','false')");        	}         	else 	{/*	             	str.append("last_modified_on > to_datetime('2022-12-02T01:00:00Z')"); /* replace to_datetime('" + last_modified_on + "')"); */                    str.append("last_modified_on > to_datetime('" + last_modified_on + "')");                    str.append(" AND fromDate = to_date('$today','YYYY-MM-DD') AND toDate = to_date('$today','YYYY-MM-DD')");                    /*                  AND fromDate = to_date('$today','YYYY-MM-DD') AND toDate = to_date('$today','YYYY-MM-DD')");  /*/*                  message.setProperty("DeltaQuery","queryMode=Delta;resultOptions=renderPreviousTags");   */                     message.setProperty("DeltaQuery","queryMode=periodDelta;resultOptions=renderPreviousTags");       	        }	}	message.setProperty("queryFilter", str.toString());	return message;}